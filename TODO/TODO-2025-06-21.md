# TODO: 2025-06-21 - Final Monorepo Fix

## Diagnosis

After a long debugging session, the root cause of the `WagmiProviderNotFoundError` and subsequent `Failed to read source code` errors has been identified as a broken monorepo dependency structure.

The `npm install` process is not correctly "hoisting" dependencies to the root `node_modules` folder in the `CCulture-Apps` workspace. Instead, it's creating nested `node_modules` folders inside the individual app directories (e.g., `coinbase/car-of-the-day/node_modules`).

This causes the Next.js compiler to look for files in the wrong location, leading to the "No such file or directory" errors seen in the browser, even after we corrected the `wagmi` versions.

## The "Ultimate Clean Slate" Plan

To fix this definitively, the entire dependency tree must be rebuilt from scratch in a clean environment.

1.  **Delete All `node_modules`:** Recursively delete every `node_modules` directory within the `CCulture-Apps` and `CCulture-Apps-Core` projects.
2.  **Delete All `package-lock.json`:** Delete the root `package-lock.json` in `CCulture-Apps` and any others that might exist.
3.  **Perform a Single, Root Install:** From the `CCulture-Apps` directory, run a single `npm install`. This will force `npm` to correctly resolve the workspace dependencies and create a single, hoisted `node_modules` directory at the root.

This will ensure all parts of the application look for dependencies in the same, correct location, finally resolving the compilation errors.

## Summary

We have undertaken a massive effort to debug the `car-of-the-day` application. The root causes were a combination of incorrect monorepo structure, conflicting `node_modules` folders, `npm` versioning issues, and incompatible dependency versions.

### Key Fixes Implemented:
1.  Corrected the project structure by removing stray top-level folders.
2.  Cleaned all incorrect build artifacts (`node_modules`, `package.json`, lockfiles) from the root project directory.
3.  Configured `nvm` to use the correct `node` and `npm` versions (`18.17.0` and `9.6.7`).
4.  Corrected the `workspaces` configuration in `CCulture-Apps/package.json` to include `CCulture-Apps-Core`.
5.  Resolved the `workspace:*` protocol issue by temporarily pinning the `@cculture/auth` version.
6.  Aligned dependency versions across multiple `package.json` files to ensure stability.
7.  Identified that a transitive dependency is still pulling in an incompatible version of `wagmi`.

## Next Steps

The final step is to use `npm`'s `overrides` feature to enforce a single version of `wagmi` across the entire project, which will solve the `WagmiProviderNotFoundError`.

1.  **[ ]** Add an `overrides` block to the root `CCulture-Apps/package.json` to force `wagmi` to version `2.10.10`.
2.  **[ ]** Run the "Ultimate Clean Slate" procedure one last time (delete all `node_modules` and `package-lock.json` files).
3.  **[ ]** Run `npm install` from the `CCulture-Apps` root.
4.  **[ ]** Start the dev server.
5.  **[ ]** Commit all the structural and dependency fixes. 